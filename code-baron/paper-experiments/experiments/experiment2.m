pieces= [-inf() 80 100 280 300 340 360	380	400	inf()];

f=[ 0.0025, -0.00250, 0, 0.0050,-0.0025, 0.0050, -0.005, -4.78350000000000e-16, 0.005004400;
-0.40, 0.40, -0.1,-2.9, 1.6, -3.5, 3.7, -0.1, -4.103520;
 2329, 2297, 2322, 2714, 2039, 2906, 1610, 2331.99999999993, 3132.7040;
];
pieces = [-inf(), 1, 2.5, 6, inf()];
f = [
    (1/2), 0, 0, 0;
    0, 2, -1, 1;
    1, -(1/2), 7, -5];


% f = [
%     0, -(4/pi^2),0,4/pi^2;
%     1, 4/pi, -1, -12/pi;
%     0,-1+pi/2,pi,9-(9*pi/2);
% ];
% pieces = [0,pi/2,pi,3*pi/2,2*pi];

no_of_bkpts_per_pieces = 1:50;
yalmiptime=[];
solvertime=[];
cputime=[];
tictoctime=[];
objs=[];

for i=2:50
    no_of_pieces = size(f,2)*i;
    tStarttic = tic;  

    [rho,new_pieces,  objective, sol]  = nearest_convex_function_variable_pieces_of_fixed_num(f,pieces,no_of_pieces);
    tEndtoc = toc(tStarttic);

    objs=[objs, value(objective)];
    yalmiptime=[yalmiptime, sol.yalmiptime];
    solvertime=[solvertime, sol.solvertime];
    tictoctime=[tictoctime, tEndtoc];

end

% objs = [9.45730291597283	9.45730295954127	9.45730297856790	9.45730289175845	9.45730331992672	9.45730293513770	9.45730294979148	9.45730293059023	9.45732815240626	9.45730291893415	9.45730288390769	9.45730297595583	9.45730287650076	9.45742577580677	9.45730314906541	9.45730298215494	9.45731171507941	9.45730302151787	9.45730289009225	9.45730340058799	9.45730293967790	9.45730286859907	9.45730634115171	9.45730298450508	9.45730309985083	NaN	9.45767707259802	9.45853376106243	9.45730293800443	9.45730293780798	9.45730297257978	9.45730293641827	9.45730285736499	9.45809647053102	9.45840756469988	9.45730293630913	9.45730293817178	9.45730293696397	9.45730285751779	9.45730293884117	9.45897659627372	9.45730293814268	9.45730293744418	9.45731273613637	9.45731333766889	9.45731171395164	NaN	9.45910116547020	9.46014833655499	9.45730278888368];
% 
% yalmiptime = [0.129871899999998	0.402906099999997	0.457555600000007	0.524398800000003	0.590922600000003	0.650595100000000	0.714936900000000	0.784600399999997	0.904597299999997	0.969273700000001	1.02770600000000	0.672794400000001	1.22600810000000	1.28346570000000	1.40066340000000	1.47100150000000	1.56826530000000	1.63367640000000	1.61841350000000	1.70758370000000	1.99632900000000	2.08073820000000	0.789852900000000	0.903985400000002	0.975744199999999	1.68062700000000	2.67384620000001	2.81660930000000	2.92026190000001	3.06037300000000	3.33981240000000	3.50652270000000	3.59963000000000	3.67563000000000	3.91729720000000	4.09173520000000	4.25402000000000	4.55728270000000	4.61659860000000	2.03232190000000	2.10713590000000	2.27487040000000	5.54488120000000	4.68751580000000	4.40872950000000	6.04275110000000	6.31285250000001	6.57501970000000	6.90991410000000	6.92557750000000];
% 
% solvertime = [14.2561281000000	1.25409390000000	1.52744440000000	1.86760120000000	2.24907740000000	2.59340490000000	2.84906310000000	2.56439960000000	4.33440270000000	4.54172630000000	3.94529400000000	5.15320560000000	5.64499190000000	6.41053430000000	5.39433660000000	8.01899850000000	7.88673470000000	7.71132360000000	8.06658650000000	8.64841630000000	8.18467100000000	8.14126180000000	6.32614710000000	7.01601460000000	7.71525580000000	8.97537300000000	10.9121538000000	11.2563907000000	13.5097381000000	12.1876270000000	14.0751876000000	13.4014773000000	13.9203700000000	14.7733700000000	19.1787028000000	19.9552648000000	13.7079800000000	18.0417173000000	19.0764014000000	10.6486781000000	17.3768641000000	20.6071296000000	40.4821188000000	25.5604842000000	49.5982705000000	18.9062489000000	26.4291475000000	34.6839803000000	37.1590859000000	23.6724225000000];
% 
% tictoctime = [16.2131650000000	5.55534070000000	6.94571720000000	8.45152460000000	9.63393780000000	11.2879477000000	12.5505776000000	13.0625273000000	16.4733813000000	17.9441561000000	19.3159747000000	21.0194901000000	25.9737495000000	26.6673167000000	26.9658598000000	34.5092098000000	39.0308724000000	43.1135029000000	45.6006987000000	48.6132042000000	53.9946150000000	54.5569432000000	34.7481300000000	38.3968154000000	43.0819317000000	73.2119525000000	78.9587210000000	84.9046750000000	88.8909524000000	99.5451227000000	114.671216600000	128.982119200000	137.883302400000	147.196934200000	160.240096400000	177.503474400000	170.238447300000	187.912596700000	206.081997200000	136.520080500000	150.656338300000	162.802954000000	236.472677700000	268.939423100000	298.127370000000	281.508476400000	320.153901900000	327.911463800000	365.509436900000	350.510963300000];
% 
% objs = [9.45730291597283	9.45730293730594	9.45730306830228	9.45730289175845	9.45730293784436	9.45731809877907	9.45730294979148	9.45730293059023	9.45731623287429	9.45730291893415	9.45732770653558	9.45730296368856	9.45730293702218	9.45730293673114	9.45730314906541	9.45730272648507	9.45733274156373	9.45730307369377	9.45730298606213	9.45730340058799	9.45730293967790	9.45730290859501	9.45730295716203	9.45730298450508	9.45730309985083	NaN	9.45767707259802	9.45853376106243	9.45730288806954	9.45730283101875	9.45730297257978	9.45731058091769	9.45730293817178	9.45809647053102	9.45840756469988	9.45730283356534	9.45730293817178	9.45730293696397	9.45730294049281	9.45730293884117	9.45736583154212	9.45730293488305	9.45730306276528	9.45731273613637	9.46281301140698	9.45731172544038	NaN	9.45910116547020	9.46014833655499	9.45730293699307];
% yalmiptime = [0.118274700000000	0.117438899999999	0.121319600000000	0.139430600000000	0.171525700000000	0.199566499999999	0.270326800000001	0.270607300000000	0.269493500000001	0.297201600000002	0.315388999999994	0.340362599999995	0.354948900000001	0.414773299999998	0.442652900000001	0.455985299999998	0.495509599999997	0.510129399999996	0.546882400000000	0.600003300000000	0.712327499999998	0.673344300000000	0.667739999999999	0.740838900000000	0.736677500000000	0.829898399999999	0.808225799999996	0.894029699999998	0.944482899999999	1.02182450000000	1.18514410000000	1.13432070000000	1.18626310000001	1.28902630000000	1.36043620000000	1.42131790000000	1.44889200000000	1.71280420000000	1.75986920000000	1.89767300000000	1.95009170000000	2.06433100000000	2.03999240000000	2.17502730000000	2.34443719999999	2.41484440000000	2.48805020000000	2.59588990000000	2.72657980000001	2.88760280000000];
% solvertime = [5.13172530000000	0.663561100000000	0.817680400000000	1.11756940000000	1.17247430000000	2.06843350000000	1.93667320000000	2.02539270000000	2.58850650000000	3.02079840000000	3.53761100000000	3.15263740000000	2.99505110000000	4.05222670000000	3.33734710000000	5.34201470000000	6.41449040000000	5.14087060000000	6.15711760000000	5.27499670000000	5.26267250000000	6.21065570000000	6.44826000000000	7.45116110000000	6.51332250000000	6.11610160000000	5.40077420000000	7.53497030000000	9.35151710000000	7.56317550000000	9.25585590000000	12.6236793000000	9.81773690000000	10.3659737000000	10.0015638000000	12.2936821000000	8.96510800000000	12.6631958000000	11.0521308000000	15.2563270000000	17.5269083000000	11.5356690000000	22.9210076000000	17.6779727000000	21.2615628000000	21.2721556000000	17.0719498000000	21.4641101000000	21.5424202000000	15.3133972000000];
% tictoctime = [5.95604590000000	1.48502060000000	1.78907550000000	2.32482250000000	2.57215590000000	3.81859190000000	4.42979960000000	4.59593320000000	5.60048840000000	6.32459870000000	7.83022210000000	7.28288620000000	7.59870110000000	9.47190660000000	8.93334070000000	11.6664627000000	13.1597943000000	12.5535593000000	14.9386898000000	15.0423230000000	15.7806425000000	17.6472869000000	18.9132523000000	21.0809373000000	21.2736368000000	22.5749136000000	22.8066949000000	36.0944643000000	39.2968044000000	41.0230463000000	45.4717994000000	51.5494890000000	51.8755742000000	56.1319895000000	58.0865209000000	63.8020012000000	64.3388700000000	76.0786017000000	100.828138800000	110.187616700000	122.457783200000	122.011744300000	138.342547100000	143.817473800000	156.128735200000	168.367876900000	169.161642100000	180.146615800000	192.822718600000	197.714334400000];

%with bounding constraints
% tictoctime=[62.5388255000000	51.0320898000000	52.8659046000000	65.3503622000000	78.7318976000000	68.1740461000000];
% objs = [9.46281301140698	9.45731172544038	NaN	9.45910116547020	9.46014833655499	9.45730293699307];
% tictoctime=[165.126786300000	176.311438900000	189.777972700000	220.043352900000	268.382572500000	269.444957500000];
% obj=[9.46281301140698	9.45731172544038	NaN	9.45910116547020	9.46014833655499	9.45730293699307];

%without bounding constraints
% tictoctime = [70.6941915000000	51.8959320000000	58.0969663000000	79.1164165000000	107.299757700000	123.649546500000];
% objs = [9.46281301140698	9.45731172544038	NaN	9.45910116547020	9.46014833655499	9.45730293699307];
% tictoctime=[101.375619100000	119.894788700000	112.707171300000	126.057734200000	160.173374100000	201.795761100000];
% objs=[9.46281301140698	9.45731172544038	NaN	9.45910116547020	9.46014833655499	9.45730293699307];

%BARON 2024 march version
tictoctime = [1.83286560000000	2.33666940000000	3.16273410000000	3.32197670000000	4.69956090000000	6.33950690000000	6.64807650000000	7.33258920000000	9.07867260000000	9.51261730000000	10.0616581000000	10.6663326000000	11.8284486000000	12.6978525000000	14.0975463000000	16.6812149000000	16.0666725000000	20.2111259000000	20.1600377000000	21.7330558000000	24.2957927000000	23.3482438000000	28.4861150000000	35.0166034000000	33.3689128000000	36.1532665000000	38.0908776000000	46.3627193000000	47.0253072000000	53.5339606000000	61.4106494000000	63.2644469000000	70.7737852000000	71.1277720000000	75.7948551000000	76.9361717000000	85.4373462000000	97.1900521000000	122.859531100000	133.588665200000	128.831314200000	153.291876100000	153.456760200000	162.252838200000	178.037990000000	189.820349900000	208.411141900000	211.856406100000	224.240231600000];
yalmiptime = [0.132259799999996	0.147734600000001	0.181693099999999	0.225644800000002	0.233428699999994	0.259489400000000	0.288702000000002	0.331971700000000	0.384641100000001	0.383036500000000	0.437134199999996	0.458312300000003	0.514638000000000	0.563320600000000	0.603519599999997	0.697858999999995	0.704296499999998	0.783180100000001	0.876299300000006	0.846099100000000	0.935273800000000	0.872801900000000	0.925104200000000	1.10426800000000	1.08164650000000	1.08356640000000	1.08594350000000	1.11522490000000	1.21817750000000	1.25399599999999	1.33704860000000	1.37421390000000	1.98305730000000	1.83309330000000	1.88707810000000	1.96726880000000	2.02567810000000	2.21285800000000	2.56640000000000	2.70443730000000	2.79065870000000	2.94119950000000	3.03369600000000	3.25017590000000	3.20331770000000	3.39253170000000	3.61271240000000	3.68760560000000	3.90793950000001];
solvertime = [1.02474020000000	1.30926540000000	1.91330690000000	1.77635520000000	2.72957130000000	3.80751060000000	3.50929800000000	3.74102830000000	3.91235890000000	5.03896350000000	4.51286580000000	4.92768770000000	5.16536200000000	4.62867940000000	5.65248040000000	7.16714100000000	5.11670350000000	8.02881990000000	6.64570070000000	6.59590090000000	7.89872620000000	6.00819810000000	9.55189580000000	12.1357320000000	9.52435350000000	10.9004336000000	11.2320565000000	10.8827751000000	9.57682250000000	11.9500040000000	16.7289514000000	14.6397861000000	12.2109427000000	11.3239067000000	13.8439219000000	10.4357312000000	12.3793219000000	11.5951420000000	20.7106000000000	24.7095627000000	13.0433413000000	28.7278005000000	20.8283040000000	20.2678241000000	25.6366823000000	27.1364683000000	32.0872876000000	24.7923944000000	30.4470605000000];
objs = [9.45730290426582	9.45730306707992	9.45730289175845	9.45730285678292	9.45731809877907	9.45730308677594	9.45730293496308	9.45731623287429	9.45730290233041	9.45732770653558	9.45730287341576	9.45730287650076	9.45730293673114	9.45730313254171	9.45730272648507	9.45736341211159	9.45730287563492	9.45730299886782	9.45734656150307	9.45730285355967	9.45730401120090	9.45730291734799	9.45730289337371	9.45730423231726	9.45822918784688	9.45730290256324	9.45730295122485	9.45730286467733	9.45730289677158	9.45730291390646	9.45731054832140	9.45730342008756	9.45809740522964	9.45840968764969	9.45730290055508	9.45730279942654	9.45730290314532	9.45730290323263	9.45733376384305	9.45730291839573	9.45730293488305	9.45730306276528	9.45730322846794	9.45730288721825	9.45734940779948	15.3675487223445	9.45730296582769	9.46014833655499	9.45730301721778];

plot(size(f,2)*no_of_bkpts_per_pieces, yalmiptime)
plot(size(f,2)*no_of_bkpts_per_pieces, solvertime)
plot(size(f,2)*no_of_bkpts_per_pieces, objs)
plot(size(f,2)*no_of_bkpts_per_pieces, tictoctime, 'LineWidth',2)
grid on;
title('Computation time vs. number of breakpoints')

xlabel('Number of breakpoints') 
ylabel('Computation Time') 
