%%CPLEX

pieces = [-inf(), 1, 2.5, 6, inf()];
f = [
    (1/2), 0, 0, 0;
    0, 2, -1, 1;
    1, -(1/2), 7, -5];


%Trial 1

objs1 = [9.45730291597283	9.45730295954127	9.45730297856790	9.45730289175845	9.45730331992672	9.45730293513770	9.45730294979148	9.45730293059023	9.45732815240626	9.45730291893415	9.45730288390769	9.45730297595583	9.45730287650076	9.45742577580677	9.45730314906541	9.45730298215494	9.45731171507941	9.45730302151787	9.45730289009225	9.45730340058799	9.45730293967790	9.45730286859907	9.45730634115171	9.45730298450508	9.45730309985083	NaN	9.45767707259802	9.45853376106243	9.45730293800443	9.45730293780798	9.45730297257978	9.45730293641827	9.45730285736499	9.45809647053102	9.45840756469988	9.45730293630913	9.45730293817178	9.45730293696397	9.45730285751779	9.45730293884117	9.45897659627372	9.45730293814268	9.45730293744418	9.45731273613637	9.45731333766889	9.45731171395164	NaN	9.45910116547020	9.46014833655499	9.45730278888368];

yalmiptime1 = [0.129871899999998	0.402906099999997	0.457555600000007	0.524398800000003	0.590922600000003	0.650595100000000	0.714936900000000	0.784600399999997	0.904597299999997	0.969273700000001	1.02770600000000	0.672794400000001	1.22600810000000	1.28346570000000	1.40066340000000	1.47100150000000	1.56826530000000	1.63367640000000	1.61841350000000	1.70758370000000	1.99632900000000	2.08073820000000	0.789852900000000	0.903985400000002	0.975744199999999	1.68062700000000	2.67384620000001	2.81660930000000	2.92026190000001	3.06037300000000	3.33981240000000	3.50652270000000	3.59963000000000	3.67563000000000	3.91729720000000	4.09173520000000	4.25402000000000	4.55728270000000	4.61659860000000	2.03232190000000	2.10713590000000	2.27487040000000	5.54488120000000	4.68751580000000	4.40872950000000	6.04275110000000	6.31285250000001	6.57501970000000	6.90991410000000	6.92557750000000];

solvertime1 = [14.2561281000000	1.25409390000000	1.52744440000000	1.86760120000000	2.24907740000000	2.59340490000000	2.84906310000000	2.56439960000000	4.33440270000000	4.54172630000000	3.94529400000000	5.15320560000000	5.64499190000000	6.41053430000000	5.39433660000000	8.01899850000000	7.88673470000000	7.71132360000000	8.06658650000000	8.64841630000000	8.18467100000000	8.14126180000000	6.32614710000000	7.01601460000000	7.71525580000000	8.97537300000000	10.9121538000000	11.2563907000000	13.5097381000000	12.1876270000000	14.0751876000000	13.4014773000000	13.9203700000000	14.7733700000000	19.1787028000000	19.9552648000000	13.7079800000000	18.0417173000000	19.0764014000000	10.6486781000000	17.3768641000000	20.6071296000000	40.4821188000000	25.5604842000000	49.5982705000000	18.9062489000000	26.4291475000000	34.6839803000000	37.1590859000000	23.6724225000000];

tictoctime1 = [16.2131650000000	5.55534070000000	6.94571720000000	8.45152460000000	9.63393780000000	11.2879477000000	12.5505776000000	13.0625273000000	16.4733813000000	17.9441561000000	19.3159747000000	21.0194901000000	25.9737495000000	26.6673167000000	26.9658598000000	34.5092098000000	39.0308724000000	43.1135029000000	45.6006987000000	48.6132042000000	53.9946150000000	54.5569432000000	34.7481300000000	38.3968154000000	43.0819317000000	73.2119525000000	78.9587210000000	84.9046750000000	88.8909524000000	99.5451227000000	114.671216600000	128.982119200000	137.883302400000	147.196934200000	160.240096400000	177.503474400000	170.238447300000	187.912596700000	206.081997200000	136.520080500000	150.656338300000	162.802954000000	236.472677700000	268.939423100000	298.127370000000	281.508476400000	320.153901900000	327.911463800000	365.509436900000	350.510963300000];

 
	
	
% 2nd trial:

objs2=[9.45730291597283	9.45730295954127	9.45730297856790	9.45730289175845	9.45730331992672	9.45730293513770	9.45730294979148	9.45730293059023	9.45732815240626	9.45730291893415	9.45730288390769	9.45730297595583	9.45730287650076	9.45742577580677	9.45730314906541	9.45730298215494	9.45731171507941	9.45730302151787	9.45730289009225	9.45730340058799	9.45730293967790	9.45730286859907	9.45730634115171	9.45730298450508	9.45730309985083	NaN	9.45767707259802	9.45853376106243	9.45730293800443	9.45730293780798	9.45730297257978	9.45730293641827	9.45730285736499	9.45809647053102	9.45840756469988	9.45730293630913	9.45730293817178	9.45730293696397	9.45730285751779	9.45730293884117	9.45897659627372	9.45730293814268	9.45730293744418	9.45731273613637	9.45731333766889	9.45731171395164	NaN	9.45910116547020	9.46014833655499	9.45730278888368];

yalmiptime2 = [0.785106399999998	0.376968900000003	0.343360900000004	0.369958400000000	0.526970199999999	0.441547900000001	0.465931699999999	0.516743800000000	0.826770800000002	0.656299099999997	0.738680299999998	0.723101499999999	0.769595600000000	0.822151800000003	1.02444270000000	1.12864160000000	1.13433060000000	1.10237760000000	1.10611850000001	1.21430690000000	1.21933520000000	1.39438640000000	1.48914780000000	1.62359210000000	1.58152380000000	1.70308250000000	1.74364900000000	1.94307880000000	2.22721400000000	2.33962810000000	2.15485460000000	2.44443730000000	2.31489420000000	2.55219310000000	2.63873090000000	2.86566530000000	2.75080390000000	3.02415960000000	3.06770240000000	3.53454270000000	3.42029350000000	3.41884910000000	3.86895830000000	3.88063660000000	4.04658060000000	4.00187480000000	4.23402820000000	4.38130530000000	4.49478600000000	4.78648780000000];

solvertime2 = [12.0938936000000	1.12803110000000	1.45063910000000	1.52604160000000	1.90102980000000	1.96445210000000	2.38506830000000	2.26525620000000	3.84322920000000	3.52470090000000	3.65231970000000	4.64989850000000	3.88140440000000	5.11084820000000	4.32655730000000	6.90735840000000	6.83766940000000	6.34762240000000	6.84588150000000	7.54469310000000	6.26866480000000	6.54161360000000	7.41985220000000	8.82740790000000	8.43247620000000	8.23991750000000	8.67135100000000	9.46792120000000	11.9657860000000	10.3153719000000	12.9731454000000	12.2385627000000	12.3291058000000	13.3118069000000	20.0272691000000	18.5523347000000	11.8771961000000	16.1228404000000	22.0642976000000	14.3204573000000	23.3397065000000	25.7591509000000	32.9380417000000	21.7523634000000	45.6214194000000	15.2631252000000	23.5189718000000	30.1216947000000	30.4002140000000	21.8765122000000];

tictoctime2 = [23.5352600000000	4.55909810000000	4.39182060000000	4.56374860000000	5.77753670000000	5.95422610000000	6.29873730000000	5.68805160000000	10.0551961000000	9.13609450000000	9.62740360000000	11.8089455000000	11.7171718000000	13.4843859000000	13.5548709000000	16.7650069000000	17.9589277000000	17.7359704000000	19.7253893000000	21.0159016000000	20.9163697000000	24.2689280000000	25.8673282000000	29.2191709000000	31.9591802000000	33.7978167000000	36.4197243000000	43.2697137000000	55.6493650000000	58.7530900000000	59.6120401000000	69.7899568000000	70.9496627000000	83.9477196000000	98.1957242000000	97.3112672000000	87.8414270000000	95.4292507000000	132.601086900000	129.442939300000	157.686306500000	161.639202300000	177.950953700000	169.686153600000	225.139021200000	180.670615600000	203.776247000000	222.362792800000	232.516813900000	234.957821500000];



% 3rd trial:

objs3 = [9.45730291597283	9.45730295954127	9.45730297856790	9.45730289175845	9.45730331992672	9.45730293513770	9.45730294979148	9.45730293059023	9.45732815240626	9.45730291893415	9.45730288390769	9.45730297595583	9.45730287650076	9.45742577580677	9.45730314906541	9.45730298215494	9.45731171507941	9.45730302151787	9.45730289009225	9.45730340058799	9.45730293967790	9.45730286859907	9.45730634115171	9.45730298450508	9.45730309985083	NaN	9.45767707259802	9.45853376106243	9.45730293800443	9.45730293780798	9.45730297257978	9.45730293641827	9.45730285736499	9.45809647053102	9.45840756469988	9.45730293630913	9.45730293817178	9.45730293696397	9.45730285751779	9.45730293884117	9.45897659627372	9.45730293814268	9.45730293744418	9.45731273613637	9.45731333766889	9.45731171395164	NaN	9.45910116547020	9.46014833655499	9.45730278888368];

yalmiptime3 = [0.562042899999996	0.328656399999997	0.414257000000000	0.455741200000001	0.499836700000004	0.559780400000001	0.621861899999996	0.883773800000001	0.856690099999999	0.868327600000000	0.989840399999997	1.09106160000000	1.04338300000000	1.17742310000000	1.40205940000000	1.45940440000000	1.68951490000000	1.58362090000000	1.56942090000000	1.73430050000000	1.74864930000000	1.98265490000000	2.25247250000000	2.17280290000000	2.13737610000000	2.32333610000000	2.40796040000000	2.57321660000000	2.69644650000000	2.88818610000000	3.07831910000000	3.07602070000000	3.29977140000000	3.62976970000000	3.70635789999999	3.61064660000000	3.56826280000000	3.70130580000000	3.81114910000000	4.14345410000000	4.45087990000000	4.52039770000000	4.32329570000000	4.90498500000000	6.15039870000000	5.03981970000000	5.39060110000000	5.39483790000000	6.15802820000000	5.97783660000000];

solvertime3 = [9.88295710000000	0.776343600000000	1.15474300000000	1.49025880000000	1.73316330000000	1.96121960000000	2.22113810000000	2.52422620000000	3.42030990000000	3.81267240000000	3.67315960000000	4.19893840000000	4.13961700000000	5.69957690000000	4.20094060000000	7.10259560000000	7.15348510000000	7.07237910000000	7.37157910000000	7.86169950000000	7.16835070000000	6.98634510000000	8.12752750000000	8.85919710000000	9.05662390000000	8.36566390000000	10.5900396000000	10.1867834000000	13.6255535000000	10.5098139000000	12.6826809000000	12.9019793000000	12.6242286000000	14.9102303000000	19.7776421000000	19.0403534000000	11.7377372000000	15.4016942000000	21.9618509000000	13.8885459000000	22.4111201000000	26.0146023000000	30.8967043000000	22.1560150000000	43.3426013000000	15.8751803000000	23.6743989000000	29.9901621000000	33.3419718000000	23.3531634000000];

tictoctime3 = [15.9619738000000	10.3555130000000	16.2149239000000	24.1592744000000	25.9238316000000	29.4353073000000	33.4957125000000	38.1909877000000	44.2343664000000	49.5430532000000	55.2962828000000	65.9489501000000	64.3280965000000	85.9697545000000	73.6086886000000	82.8590775000000	90.9044783000000	101.867716000000	118.087876600000	115.236994100000	113.378441300000	117.351785600000	125.926861300000	134.954630000000	136.529384600000	149.770493400000	159.704669200000	168.027785900000	178.159428600000	185.549215200000	195.657332900000	203.258597800000	211.396854700000	233.262883100000	255.911001500000	262.596805400000	246.165020900000	255.785044100000	275.081520900000	287.173183800000	302.523482000000	322.913411700000	333.968563600000	336.524563900000	415.864397700000	395.884356700000	391.234505000000	427.680751700000	449.330289500000	465.515524400000];




gran = [1:50];
gran=4*gran;

%Min graph
obj_min = [];
yalmiptime_min=[];
solvertime_min=[];
tictoctime_min=[];
for i=1:size(objs1,2)
    yalmiptime_min = [yalmiptime_min, min([yalmiptime3(i),yalmiptime2(i),yalmiptime1(i)])];
    solvertime_min = [solvertime_min, min([solvertime3(i),solvertime2(i),solvertime1(i)])];
    tictoctime_min = [tictoctime_min, min([tictoctime3(i),tictoctime2(i),tictoctime1(i)])];
end

% plot(gran, objs, 'LineWidth', 1.5);
% grid on;
% title('Objective values vs. number of breakpoints')
% 
% xlabel('Number of breakpoints') 
% ylabel('Objective Values') 


% plot(gran, tictoctime_min, 'LineWidth', 2);
% grid on;
% title('Computation time vs. number of breakpoints')
% 
% xlabel('Number of breakpoints') 
% ylabel('Computation Time') 

no_of_bkpts_per_pieces = [1:50];
% plot(size(f,2)*no_of_bkpts_per_pieces, yalmiptime)
% plot(size(f,2)*no_of_bkpts_per_pieces, solvertime)
% plot(size(f,2)*no_of_bkpts_per_pieces, objs)
plot(size(f,2)*no_of_bkpts_per_pieces, tictoctime_min, 'LineWidth',2)
grid on;
title('Computation time vs. number of breakpoints')

xlabel('Number of breakpoints') 
ylabel('Computation Time') 

hold on;

%Avg graph
obj_avg = (objs1+objs2+objs3)/3;
yalmiptime_avg = (yalmiptime1+yalmiptime2+yalmiptime3)/3;
solvertime_avg = (solvertime1+solvertime2+solvertime3)/3;
tictoctime_avg = (tictoctime1+tictoctime2+tictoctime3)/3;

% plot(gran, obj_avg, 'LineWidth', 1.5);
% grid on;
% title('Objective values vs. number of breakpoints')
% 
% xlabel('Number of breakpoints') 
% ylabel('Objective Values') 
no_of_bkpts_per_pieces = [1:50];
% plot(size(f,2)*no_of_bkpts_per_pieces, yalmiptime)
% plot(size(f,2)*no_of_bkpts_per_pieces, solvertime)
% plot(size(f,2)*no_of_bkpts_per_pieces, objs)
plot(size(f,2)*no_of_bkpts_per_pieces, tictoctime_avg, 'LineWidth',2)
grid on;
title('Computation time vs. number of breakpoints')

xlabel('Number of breakpoints') 
ylabel('Computation Time') 


% plot(gran, tictoctime_avg, 'LineWidth', 2);
% grid on;
% title('Computation time vs. number of breakpoints')
% 
% xlabel('Number of breakpoints') 
% ylabel('Computation Time') 